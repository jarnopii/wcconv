<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>v2rayconverter</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script
  async="async"
  data-cfasync="false"
  src="//pl28218839.effectivegatecpm.com/b3e812e6cd85ff46925ddd2f5ed528fa/invoke.js"
></script>
<div id="container-b3e812e6cd85ff46925ddd2f5ed528fa"></div>
    
<style>
:root {
    --bg: #eef2f7;
    --card: #ffffff;
    --text: #2b2f36;
    --subtext: #555;
    --input-bg: #ffffff;
    --border: #c7ced8;
    --primary: #4f8cff;
    --primary-hover: #3673e6;
    --output-bg: #f8fafc;
}

body.dark {
    --bg: #1e1f26;
    --card: #2a2c36;
    --text: #e7e9ef;
    --subtext: #aaa;
    --input-bg: #2f313d;
    --border: #555b6b;
    --primary: #6d9dff;
    --primary-hover: #5a89eb;
    --output-bg: #2d2f3a;
}

body {
    font-family: "Segoe UI", Arial, sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 0;
    transition: background 0.4s ease;
}

.container {
    max-width: 850px;
    margin: 60px auto;
    background: var(--card);
    padding: 25px 30px;
    border-radius: 14px;
    box-shadow: 0 5px 25px rgba(0,0,0,0.1);
    animation: fadeIn 0.7s ease;
    position: relative;
    z-index: 1;
}

@keyframes fadeIn { from { opacity:0; transform:translateY(10px); } to { opacity:1; transform:translateY(0); } }

textarea {
    width: 100%;
    padding: 12px;
    border: 1.5px solid var(--border);
    background: var(--input-bg);
    border-radius: 10px;
    font-family: monospace;
    font-size: 14px;
    resize: vertical;
    outline: none;
    color: var(--text);
    transition: border 0.25s, background 0.25s, box-shadow 0.25s, transform 0.1s;
}

textarea:focus {
    border-color: var(--primary);
    box-shadow: 0 0 6px rgba(79,140,255,0.45);
    transform: scale(1.01);
}

h2 { text-align:center; color: var(--text); }
.desc { text-align:center; color: var(--subtext); margin-bottom:20px; }
.btn-row { display:flex; gap:10px; margin-top:15px; }

button { flex:1; padding:12px 15px; border:none; border-radius:10px; cursor:pointer; font-size:15px; font-weight:600; transition:0.25s ease; }
button:hover { transform:scale(1.05); }
button:active { transform:scale(0.95); }

.btn-primary { background: var(--primary); color:white; }
.btn-primary:hover { background: var(--primary-hover); }

.btn-secondary { background: var(--border); color: var(--text); }

#output { background: var(--output-bg); border-left: 4px solid var(--primary); height:150px; margin-top:8px; }

.dark-toggle { position: fixed; top:15px; right:20px; z-index:9999; background:var(--card); color:var(--text); border:1px solid var(--border); padding:10px 16px; border-radius:30px; cursor:pointer; font-weight:bold; box-shadow:0 3px 12px rgba(0,0,0,0.15); transition:0.3s; }
.dark-toggle:hover { transform: scale(1.12); }

.footer { text-align:center; font-size:13px; margin-top:25px; color:var(--subtext); }

/* Tombol copy di bawah hasil */
.copy-row { display:flex; justify-content:flex-end; margin-top:8px; }
</style>
</head>

<body>

<div class="dark-toggle" onclick="toggleDarkMode()">Light/Dark</div>

<div class="container">
<h2>raw V2ray WS to WC Converter</h2>
<div class="desc">wildcard converter made by @fajarsanespajarr</div>

<label><b>Input V2ray *raw:</b></label>
<textarea id="input" placeholder="vless://... or vmess://..."></textarea>

<div class="btn-row">
<button class="btn-primary" onclick="convert()">Convert</button>
<button class="btn-secondary" onclick="clearAll()">Clear</button>
</div>

<label style="margin-top:20px;"><b>Hasil:</b></label>
<textarea id="output" readonly placeholder="Klik Convert dulu bg..."></textarea>

<div class="copy-row">
<button class="btn-secondary" onclick="copyOutput()">Copy</button>
</div>

<div class="footer">WC Converter â€¢ Ada bug? lapor ke tele @fajarsanespajarr</div>
</div>

<script>
function toggleDarkMode(){ document.body.classList.toggle("dark"); }

/* Base64 Helper */
function decodeBase64(str){
    str = str.replace(/-/g,'+').replace(/_/g,'/');
    while(str.length %4) str += '=';
    return decodeURIComponent(Array.prototype.map.call(atob(str), c=> '%'+('00'+c.charCodeAt(0).toString(16)).slice(-2)).join(''));
}
function encodeBase64(str){
    return btoa(encodeURIComponent(str).replace(/%([0-9A-F]{2})/g,(m,p)=>String.fromCharCode('0x'+p)));
}

/* VLESS Converter */
function convertVless(url){
    try{
        if(!url.startsWith("vless://")) return null;
        let full = url.trim();
        let afterAt = full.split("@")[1];
        let bugHost = afterAt.split(":")[0];
        let queryPart = full.split("?")[1];
        let params = new URLSearchParams(queryPart);
        let oldHost = params.get("host");
        let oldSni  = params.get("sni");
        let newHost = bugHost+"."+oldHost;
        params.set("host", newHost);
        if(oldSni) params.set("sni", newHost);
        return full.split("?")[0] + "?" + params.toString();
    }catch{return null;}
}

/* VMESS Base64 Converter */
function convertVmess(url){
    try{
        if(!url.startsWith("vmess://")) return null;
        let payload = url.slice(8);
        let decoded = decodeBase64(payload);
        let obj = JSON.parse(decoded);
        let oldHost = obj.host || (obj.add || '');
        let bugHost = obj.add || oldHost;
        let newHost = bugHost+"."+oldHost;
        obj.host = newHost;
        if(obj.sni) obj.sni = newHost;
        let reencoded = encodeBase64(JSON.stringify(obj));
        return "vmess://"+reencoded;
    }catch{return null;}
}

function convert(){
    let input = document.getElementById("input").value.trim().split("\n");
    let results = [];
    input.forEach(line=>{
        let l=line.trim();
        if(l.startsWith("vless://")) results.push(convertVless(l)||"INVALID: "+l);
        else if(l.startsWith("vmess://")) results.push(convertVmess(l)||"INVALID: "+l);
        else results.push("INVALID: "+l);
    });
    document.getElementById("output").value = results.join("\n");
}

/* Copy & Clear */
function copyOutput(){
    let out = document.getElementById("output").value.trim();
    if(!out) return alert("Tidak ada hasil untuk disalin.");
    if(navigator.clipboard) navigator.clipboard.writeText(out).then(()=>alert("Berhasil disalin!")).catch(()=>fallbackCopy(out));
    else fallbackCopy(out);
}
function fallbackCopy(text){
    let temp=document.createElement("textarea");
    temp.value=text;
    document.body.appendChild(temp);
    temp.select();
    document.execCommand("copy");
    document.body.removeChild(temp);
    alert("Berhasil disalin!");
}
function clearAll(){ document.getElementById("input").value=""; document.getElementById("output").value=""; }
</script>
</body>
  </html>
